# üéØ –§–ò–ù–ê–õ–¨–ù–û–ï –¢–ï–•–ù–ò–ß–ï–°–ö–û–ï –ó–ê–î–ê–ù–ò–ï (–ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ï)
## "ZenBalance" ‚Äî –†–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –ò–º–ø—É–ª—å—Å-–°—Ç–æ–ø–ø–µ—Ä (–¢-–ë–∞–Ω–∫)

**–í–µ—Ä—Å–∏—è:** 2.0 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ –¢–ó –¢-–ë–∞–Ω–∫–∞)  
**–î–∞—Ç–∞:** 05.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

---

## 1. –û–ë–ó–û–† –ü–†–û–ï–ö–¢–ê

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π **–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏–º–ø—É–ª—å—Å–∏–≤–Ω—ã–µ –∂–µ–ª–∞–Ω–∏—è** –∏ –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Å—Ç—ã—Ç—å –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É "–æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è" (cooling-off), –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –ò–ò-–æ—Ü–µ–Ω–∫—É —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç–∏.

**–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ:** –ò–° –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞–µ—Ç –¥–Ω–∏, –Ω–æ **–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∂–µ–ª–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –ò–ò**, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫ —Å —á–µ—Ä–Ω—ã–º —Å–ø–∏—Å–∫–æ–º –∏ –¥–∞–µ—Ç **–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Å–æ–≤–µ—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è + **—Ä–µ–≥—É–ª—è—Ä–Ω–æ –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç: "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?"**

**–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã:** Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö + –ü–ö).

**NO-AUTH:** –í—Ö–æ–¥ –ø–æ –Ω–∏–∫–Ω–µ–π–º—É –±–µ–∑ –ø–∞—Ä–æ–ª—è.

---

## 2. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (4-—Ö —Å–ª–æ–π–Ω–∞—è)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           FRONTEND (React + Vite)                   ‚îÇ
‚îÇ  (–û–Ω–±–æ—Ä–¥–∏–Ω–≥ ‚Üí –í–≤–æ–¥ —Ç–æ–≤–∞—Ä–∞ ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –õ–ö)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      BACKEND (Node.js + Express)                    ‚îÇ
‚îÇ  (REST API, CRUD, –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞, –†–æ—É—Ç–∏–Ω–≥ –≤ –ò–ò)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      AI-LAYER (Python + FastAPI)                    ‚îÇ
‚îÇ  (LLM –¥–ª—è —Å–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏, –ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π,         ‚îÇ
‚îÇ   –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–≤–µ—Ç–æ–≤, –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –æ–ø—Ä–æ—Å—ã)         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ    DATABASE (SQLite –∏–ª–∏ PostgreSQL)                 ‚îÇ
‚îÇ  (–ü—Ä–æ—Ñ–∏–ª–∏, –ß–µ—Ä–Ω—ã–µ —Å–ø–∏—Å–∫–∏, Wishlist, –ò—Å—Ç–æ—Ä–∏—è)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 3. MUST-HAVE –§–ò–ß–ò (–ö—Ä–∏—Ç–∏—á–Ω–æ)

### 3.1 –≠–∫—Ä–∞–Ω –û–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ (–ê–Ω–∫–µ—Ç–∞ + –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ò–°)

**–®–∞–≥ 1: –õ–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–§–æ—Ä–º–∞)**
- –ù–∏–∫–Ω–µ–π–º (3-20 —Å–∏–º–≤–æ–ª–æ–≤, —É–Ω–∏–∫–∞–ª—å–Ω—ã–π, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage)
- –ú–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥ (—á–∏—Å–ª–æ –≤ —Ä—É–±–ª—è—Ö)
- –°—É–º–º–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º—ã—Ö —Å–±–µ—Ä–µ–∂–µ–Ω–∏–π –≤ –º–µ—Å—è—Ü (—á–∏—Å–ª–æ –≤ —Ä—É–±–ª—è—Ö)
- –¢–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è (—á–∏—Å–ª–æ –≤ —Ä—É–±–ª—è—Ö)
- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å: "–£—á–∏—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ" (–≤–∫–ª—é—á–µ–Ω–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

**–®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ò–°**

**A) –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–ß–µ–∫–±–æ–∫—Å—ã):**
- –¢–µ—Ö–Ω–∏–∫–∞
- –í–∏–¥–µ–æ–∏–≥—Ä—ã / –ê–∑–∞—Ä—Ç–Ω—ã–µ –∏–≥—Ä—ã
- –ö–æ—Å–º–µ—Ç–∏–∫–∞
- –û–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å
- –ï–¥–∞ (–¥–æ—Å—Ç–∞–≤–∫–∞, —Ñ–∞—Å—Ç—Ñ—É–¥)
- –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è (–∫–∏–Ω–æ, –∫–æ–Ω—Ü–µ—Ä—Ç—ã)
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–≤–æ–¥ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç —Å–≤–æ—é)

**B) –î–∏–∞–ø–∞–∑–æ–Ω—ã –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (–†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–∞—è —Ç–∞–±–ª–∏—Ü–∞):**
```
–°—É–º–º–∞ (–æ—Ç-–¥–æ)          ‚îÇ –î–Ω–∏ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–¥–æ 15 000 ‚ÇΩ            ‚îÇ 1 –¥–µ–Ω—å
15 000 - 50 000 ‚ÇΩ      ‚îÇ 7 –¥–Ω–µ–π
50 000 - 100 000 ‚ÇΩ     ‚îÇ 30 –¥–Ω–µ–π
100 000 - 200 000 ‚ÇΩ    ‚îÇ 60 –¥–Ω–µ–π
200 000+ ‚ÇΩ             ‚îÇ 90 –¥–Ω–µ–π
```
*–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã*

**C) –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π:**
- –ß–∞—Å—Ç–æ—Ç–∞: "–†–∞–∑ –≤ –¥–µ–Ω—å" / "–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é" / "–†–∞–∑ –≤ –º–µ—Å—è—Ü"
- –ö–∞–Ω–∞–ª: "–ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è" / "Email (SMTP)" / "Telegram"
- –ß–µ–∫–±–æ–∫—Å: "–ò—Å–∫–ª—é—á–∏—Ç—å —Ç–æ–≤–∞—Ä—ã –∏–∑ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π" (–¥–∞/–Ω–µ—Ç)

**–•—Ä–∞–Ω–∏–ª–∏—â–µ:** –ë–î (SQLite/PostgreSQL) + LocalStorage –¥–ª—è —é–∑–µ—Ä–∞

---

### 3.2 –ì–ª–∞–≤–Ω—ã–π –≠–∫—Ä–∞–Ω (–í–≤–æ–¥ –ñ–µ–ª–∞–µ–º–æ–π –ü–æ–∫—É–ø–∫–∏ + –ò–ò-–ê–Ω–∞–ª–∏–∑)

**UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
1. **–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞** (Text Input, –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
2. **–¶–µ–Ω–∞** (Number Input, –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω–∞, –≤–∞–ª—é—Ç–∞ = –†–£–ë)
3. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è** (Select —Å 15-—é –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏, –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω–∞)
4. **–ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"** ‚Üí POST `/api/products/check`

**–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å":**
1. –§—Ä–æ–Ω—Ç–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/products/check` —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞ –∏ –ø—Ä–æ—Ñ–∏–ª–µ–º —é–∑–µ—Ä–∞
2. –ë—ç–∫ –≤—ã–∑—ã–≤–∞–µ—Ç –ò–ò-—Å–µ—Ä–≤–∏—Å (Python FastAPI)
3. –ò–ò –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–æ–≤–∞—Ä –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

---

### 3.3 –ò–ò-–°–õ–û–ô (4 —Ñ—É–Ω–∫—Ü–∏–∏ LLM)

**–ò—Å–ø–æ–ª—å–∑—É–µ–º:** GPT-4o-mini (OpenAI)

#### –§—É–Ω–∫—Ü–∏—è 1: –°–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π

```python
# Endpoint: POST /ai/category-similarity
# –í—ã–∑–æ–≤–µ—Ç—Å—è –∏–∑: POST /api/products/check
# Input:
{
  "user_category": "–ò–≥—Ä–æ–≤–∞—è –∫–æ–Ω—Å–æ–ª—å",
  "blacklist_categories": ["–¢–µ—Ö–Ω–∏–∫–∞", "–í–∏–¥–µ–æ–∏–≥—Ä—ã", "–ì–∞–¥–∂–µ—Ç—ã"]
}

# LLM –ü—Ä–æ–º—Ç:
"""You are a financial category analyzer.
Compare the user's desired product category with their blacklist categories.

User's product category: "{user_category}"
Blacklist categories: {blacklist_categories}

Your task:
1. Determine if the user's category is related to ANY blacklist category
2. Return confidence score from 0 to 1
3. Explain which blacklist category it matches (if any)

Return ONLY valid JSON (no markdown):
{
  "is_blocked": true/false,
  "similarity": 0.0-1.0,
  "related_to": "which blacklist category (if any)",
  "reason": "brief explanation in Russian"
}"""

# Output:
{
  "is_blocked": true,
  "similarity": 0.95,
  "related_to": "–í–∏–¥–µ–æ–∏–≥—Ä—ã, –¢–µ—Ö–Ω–∏–∫–∞",
  "reason": "–ò–≥—Ä–æ–≤–∞—è –∫–æ–Ω—Å–æ–ª—å ‚Äî —ç—Ç–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤–∏–¥–µ–æ–∏–≥—Ä (–∑–∞–ø—Ä–µ—â–µ–Ω–æ)"
}

# Logic: –ï—Å–ª–∏ similarity > 0.7 ‚Üí BLOCK —Ç–æ–≤–∞—Ä
```

#### –§—É–Ω–∫—Ü–∏—è 2: –ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏

```python
# Endpoint: POST /ai/purchase-advice
# –í—ã–∑–æ–≤–µ—Ç—Å—è –∏–∑: POST /api/products/check
# Input:
{
  "product_name": "MacBook Pro",
  "price": 150000,
  "user_income": 100000,
  "user_savings": 80000,
  "monthly_savings": 5000,
  "cooling_days": 30
}

# LLM –ü—Ä–æ–º—Ç:
"""You are a personal finance coach.
User wants to buy: {product_name} for ‚ÇΩ{price}

Context:
- Monthly income: ‚ÇΩ{user_income}
- Current savings: ‚ÇΩ{user_savings}
- Monthly savings: ‚ÇΩ{monthly_savings}
- Recommended cooling period: {cooling_days} days

Your task:
1. Analyze if this purchase is financially reasonable
2. Give SHORT (max 50 words) advice in Russian
3. Be empathetic but honest about risks
4. Suggest alternatives if needed

Return ONLY valid JSON (no markdown):
{
  "status": "APPROVED" | "COOLING" | "BLOCKED",
  "advice": "your advice in Russian (max 50 words)",
  "key_message": "one-line summary",
  "confidence": 0.0-1.0
}"""

# Output:
{
  "status": "COOLING",
  "advice": "–≠—Ç–æ 15% —Ç–≤–æ–µ–≥–æ –¥–æ—Ö–æ–¥–∞. –ü–æ–¥–æ–∂–¥–∏ 30 –¥–Ω–µ–π, –Ω–∞–∫–æ–ø–∏—à—å –µ—â–µ 5k, –∏ –ø–æ–∫—É–ø–∫–∞ –±—É–¥–µ—Ç –∫–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ.",
  "key_message": "–°–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ. –û—Ç–ª–æ–∂–∏ –Ω–∞ –º–µ—Å—è—Ü.",
  "confidence": 0.85
}
```

#### –§—É–Ω–∫—Ü–∏—è 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞

```python
# Endpoint: POST /ai/generate-survey
# –í—ã–∑–æ–≤–µ—Ç—Å—è –∏–∑: –ö—Ä–æ–Ω-–∑–∞–¥–∞—á–∞ (—Ä–∞–∑ –≤ –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é)
# Input:
{
  "wishlist_items": [
    { "name": "MacBook Pro", "price": 150000, "days_left": 20, "status": "WAITING" },
    { "name": "–ö—Ä–æ—Å—Å–æ–≤–∫–∏", "price": 8000, "days_left": 0, "status": "READY" },
    { "name": "–ù–∞—É—à–Ω–∏–∫–∏", "price": 12000, "days_left": 7, "status": "WAITING" }
  ],
  "nickname": "Ivan",
  "monthly_savings": 5000
}

# LLM –ü—Ä–æ–º—Ç:
"""You are a financial wellness assistant.
Generate an INTERACTIVE SURVEY for user {nickname} about their wishlist.

Items in wishlist:
{wishlist_items_formatted}

Your task:
1. For each item, generate a SHORT question: "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?"
2. Include status info (waiting X days, or ready to buy)
3. Provide 3 options for EACH item:
   - "–î–∞, –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ö–æ—á—É" (keep)
   - "–ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å" (delete)
   - "–û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é" (postpone)
4. Keep tone friendly and supportive
5. Use emojis

Return ONLY valid JSON (no markdown):
{
  "title": "–¢–≤–æ–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ–ø—Ä–æ—Å üìã",
  "items": [
    {
      "product_name": "...",
      "price": 0,
      "question": "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?",
      "status": "waiting" | "ready",
      "days_left": 0,
      "options": [
        { "label": "–î–∞, –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ö–æ—á—É", "action": "keep" },
        { "label": "–ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å", "action": "delete" },
        { "label": "–û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é", "action": "postpone" }
      ]
    }
  ],
  "message": "–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ —Å–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è –∏ —Å–∫–∞–∂–∏, —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ?"
}"""

# Output:
{
  "title": "–¢–≤–æ–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ–ø—Ä–æ—Å üìã",
  "items": [
    {
      "product_name": "MacBook Pro",
      "price": 150000,
      "question": "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ? –û—Å—Ç–∞–ª–æ—Å—å –∂–¥–∞—Ç—å 20 –¥–Ω–µ–π üñ•Ô∏è",
      "status": "waiting",
      "days_left": 20,
      "options": [
        { "label": "–î–∞, –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ö–æ—á—É", "action": "keep" },
        { "label": "–ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å", "action": "delete" },
        { "label": "–û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é", "action": "postpone" }
      ]
    },
    {
      "product_name": "–ö—Ä–æ—Å—Å–æ–≤–∫–∏",
      "price": 8000,
      "question": "–ö—Ä–æ—Å—Å–æ–≤–∫–∏ –≥–æ—Ç–æ–≤—ã! –ö—É–ø–∏—Ç—å? ‚úÖ",
      "status": "ready",
      "days_left": 0,
      "options": [...]
    }
  ],
  "message": "–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ —Å–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è –∏ —Å–∫–∞–∂–∏, —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ? ‚ú®"
}
```

#### –§—É–Ω–∫—Ü–∏—è 4: –ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```python
# Endpoint: POST /ai/motivation
# –í—ã–∑–æ–≤–µ—Ç—Å—è –∏–∑: –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞ –∏–∑ wishlist
# Input:
{
  "action": "product_removed" | "product_ready" | "impulse_detected",
  "product_name": "MacBook Pro",
  "nickname": "Ivan",
  "price": 150000,
  "savings_delta": 5000  # —Å–∫–æ–ª—å–∫–æ –Ω–∞–∫–æ–ø–∏–ª –∑–∞ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
}

# LLM –ü—Ä–æ–º—Ç:
"""You are a supportive financial coach for {nickname}.
Generate a SHORT motivational message (20-30 words max) in Russian.

Action: {action_description}
Product: {product_name}
Price: ‚ÇΩ{price}

Be encouraging but realistic. Include emojis.
Tone: like a friend who understands financial goals.

Return ONLY valid JSON (no markdown):
{
  "message": "your motivational message here"
}"""

# Output:
{
  "message": "–í—ã–∏–≥—Ä–∞–ª! –ü—Ä–æ–ø—É—Å—Ç–∏–ª –∏–º–ø—É–ª—å—Å –Ω–∞ 15k. –≠—Ç–æ +1% –±–ª–∏–∂–µ –∫ —Ü–µ–ª—è–º. üí™"
}
```

---

### 3.4 –ë–∏–∑–Ω–µ—Å-–õ–æ–≥–∏–∫–∞ (Core Algorithm –Ω–∞ –ë—ç–∫–µ)

```javascript
async function checkProduct(productData, userProfile) {
  // –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ß–µ—Ä–Ω–æ–≥–æ –°–ø–∏—Å–∫–∞ —á–µ—Ä–µ–∑ –ò–ò
  const { is_blocked, similarity } = await aiService.checkCategorySimilarity(
    productData.category,
    userProfile.blacklist_categories
  );
  
  if (is_blocked && similarity > 0.7) {
    return {
      status: "BLOCKED",
      reason: "–ö–∞—Ç–µ–≥–æ—Ä–∏—è –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ",
      ai_reason: reason
    };
  }
  
  // –®–ê–ì 2: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è –ø–æ —Ü–µ–Ω–µ
  const cooling_days_by_price = getCoolingPeriodByPrice(
    productData.price,
    userProfile.cooling_ranges
  );
  
  // –®–ê–ì 3: –†–∞—Å—á–µ—Ç –¥–Ω–µ–π –ø–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è–º (–¢–ó –¢-–ë–∞–Ω–∫–∞: "–ø–æ–ª–æ–≤–∏–Ω–∞ –æ—Ç –º–µ—Å—è—á–Ω–æ–≥–æ –æ–±—ä–µ–º–∞")
  let final_cooling_days = cooling_days_by_price;
  if (userProfile.use_savings) {
    // –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –§–û–†–ú–£–õ–ê (–¢–ó –¢-–ë–∞–Ω–∫–∞):
    // –ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è –∫–∞–∫ –º–∏–Ω–∏–º—É–º –ø–æ–ª–æ–≤–∏–Ω–∞ –æ—Ç –º–µ—Å—è—á–Ω–æ–≥–æ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è
    const comfortable_sum = productData.price + (userProfile.monthly_savings * 0.5);
    const days_to_afford = Math.max(0, 
      Math.ceil((comfortable_sum - userProfile.current_savings) / userProfile.monthly_savings * 30)
    );
    final_cooling_days = Math.max(cooling_days_by_price, days_to_afford);
  }
  
  // –®–ê–ì 4: –ü–æ–ª—É—á–∏—Ç—å –ò–ò-—Å–æ–≤–µ—Ç
  const advice = await aiService.getPurchaseAdvice({
    product_name: productData.name,
    price: productData.price,
    user_income: userProfile.income,
    user_savings: userProfile.current_savings,
    monthly_savings: userProfile.monthly_savings,
    cooling_days: final_cooling_days
  });
  
  return {
    status: "COOLING",
    cooling_days: final_cooling_days,
    unlock_date: addDays(today, final_cooling_days),
    ai_advice: advice,
    can_afford_now: userProfile.current_savings >= productData.price
  };
}
```

---

### 3.5 –≠–∫—Ä–∞–Ω –†–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–ü–æ—Å–ª–µ –ê–Ω–∞–ª–∏–∑–∞)

**–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å = BLOCKED:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  üö´ –ü–û–ö–£–ü–ö–ê –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–ê              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  –ö–∞—Ç–µ–≥–æ—Ä–∏—è "–í–∏–¥–µ–æ–∏–≥—Ä—ã" –≤ —á–µ—Ä–Ω–æ–º —Å–ø–∏—Å–∫–µ ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üí° –°–æ–≤–µ—Ç –æ—Ç –ò–ò:                      ‚îÇ
‚îÇ  "{ai_reason_from_llm}"                ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  [–í–µ—Ä–Ω—É—Ç—å—Å—è] [–ò–∑–º–µ–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å = COOLING:**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ‚è±Ô∏è –ü–ï–†–ò–û–î –û–•–õ–ê–ñ–î–ï–ù–ò–Ø: {cooling_days} ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  {product_name} ‚Äî {price} ‚ÇΩ            ‚îÇ
‚îÇ  –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞: {unlock_date}          ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –ò–ò:                  ‚îÇ
‚îÇ  "{ai_advice_from_llm}"                ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  –°—Ç–∞—Ç—É—Å: –ù–∞–∫–æ–ø–ª–µ–Ω–æ {current}k          ‚îÇ
‚îÇ  (–Ω—É–∂–Ω–æ –µ—â–µ {needed}k)                 ‚îÇ
‚îÇ                                        ‚îÇ
‚îÇ  [–î–æ–±–∞–≤–∏—Ç—å –≤ Wishlist] [–ó–∞–±—ã—Ç—å]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 3.6 –õ–∏—á–Ω—ã–π –ö–∞–±–∏–Ω–µ—Ç (3 –≤–∫–ª–∞–¥–∫–∏ + –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–æ—Å)

#### –í–∫–ª–∞–¥–∫–∞ 1: Wishlist (–ê–∫—Ç–∏–≤–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã)

```
–¢–æ–≤–∞—Ä              –¶–µ–Ω–∞      –°—Ç–∞—Ç—É—Å         –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞  –ò—Å–∫–ª—é—á–∏—Ç—å?
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
MacBook Pro       150 000   –ñ–î–Å–¢ (20 –¥–Ω)   04.01.2026     [‚òê]
–ö—Ä–æ—Å—Å–æ–≤–∫–∏          8 000    –ì–û–¢–û–í–û!        ‚úÖ             [‚òê]
–ù–∞—É—à–Ω–∏–∫–∏          12 000    –ñ–î–Å–¢ (7 –¥–Ω)    28.12.2025     [‚òë]
```

**–ö–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞:** –ö—É–ø–∏—Ç—å / –£–¥–∞–ª–∏—Ç—å / –û—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ –Ω–µ–¥–µ–ª—é

**–ß–µ–∫–±–æ–∫—Å "–ò—Å–∫–ª—é—á–∏—Ç—å?" ‚Üí –∏—Å–∫–ª—é—á–∞–µ—Ç —Ç–æ–≤–∞—Ä –∏–∑ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π**

#### –í–∫–ª–∞–¥–∫–∞ 2: –ò—Å—Ç–æ—Ä–∏—è

```
–î–µ–π—Å—Ç–≤–∏–µ                  –¢–æ–≤–∞—Ä           –¶–µ–Ω–∞      –î–∞—Ç–∞
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
‚úÖ –ö—É–ø–∏–ª                 –ù–∞—É—à–Ω–∏–∫–∏ JBL     5 000    20.12.2025
‚ùå –£–¥–∞–ª–∏–ª (–∏–º–ø—É–ª—å—Å)      –ö–∏–Ω–æ –±–∏–ª–µ—Ç—ã      1 500    15.12.2025
‚è∏Ô∏è –û—Ç–ª–æ–∂–∏–ª –Ω–∞ –Ω–µ–¥–µ–ª—é     –ö–æ—Å–º–µ—Ç–∏–∫–∞ MAC    3 000    10.12.2025
```

#### –í–∫–ª–∞–¥–∫–∞ 3: –ü—Ä–æ—Ñ–∏–ª—å (—Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º)

```
–ù–∏–∫–Ω–µ–π–º: Ivan
–ú–µ—Å—è—á–Ω—ã–π –¥–æ—Ö–æ–¥: 100 000 ‚ÇΩ [edit]
–û—Ç–∫–ª–∞–¥—ã–≤–∞—é –≤ –º–µ—Å—è—Ü: 5 000 ‚ÇΩ [edit]
–¢–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è: 80 000 ‚ÇΩ [edit]

‚òë –£—á–∏—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è

–ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: [edit]
  ‚òë –¢–µ—Ö–Ω–∏–∫–∞
  ‚òë –í–∏–¥–µ–æ–∏–≥—Ä—ã
  ‚òë –û–¥–µ–∂–¥–∞
  ‚òê –ï–¥–∞

–î–∏–∞–ø–∞–∑–æ–Ω—ã –æ—Ö–ª–∞–∂–¥–µ–Ω–∏–π: [edit —Ç–∞–±–ª–∏—Ü–∞]
–ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: [edit]

[–°–æ—Ö—Ä–∞–Ω–∏—Ç—å] [–í—ã—Ö–æ–¥]
```

#### üÜï –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–´–ô –û–ü–†–û–° (–ü—Ä–∏ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é/–º–µ—Å—è—Ü –±—ç–∫ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ –ò–ò
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –æ–ø—Ä–æ—Å–æ–º (–±—Ä–∞—É–∑–µ—Ä / Email / Telegram)
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –ø—Ä—è–º–æ –∏–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
4. –ü—Ä–∏ –æ—Ç–≤–µ—Ç–µ —Ç–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ wishlist

**–ü—Ä–∏–º–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
```
üìã –¢–≤–æ–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ–ø—Ä–æ—Å

‚ñ° MacBook Pro (150k) ‚Äî –¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å? –û—Å—Ç–∞–ª–æ—Å—å 20 –¥–Ω–µ–π ‚è±Ô∏è
  ‚äô –î–∞, –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ö–æ—á—É
  ‚óã –ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å
  ‚óã –û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é

‚ñ° –ö—Ä–æ—Å—Å–æ–≤–∫–∏ (8k) ‚Äî –û–Ω–∏ –≥–æ—Ç–æ–≤—ã –∫ –ø–æ–∫—É–ø–∫–µ! ‚úÖ
  ‚äô –î–∞, –∫—É–ø–∏—Ç—å
  ‚óã –ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å
  ‚óã –û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é

[–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã]
```

---

### 3.7 –°–∏—Å—Ç–µ–º–∞ –ù–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π (–ò–ò-Powered)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ö—Ä–æ–Ω-–∑–∞–¥–∞—á–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 09:00 –ø—Ä–æ–≤–µ—Ä—è–µ—Ç wishlist
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —é–∑–µ—Ä–∞ –ò–ò –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **–æ–¥–∏–Ω –æ–±—â–∏–π –æ–ø—Ä–æ—Å** —Å–æ –≤—Å–µ–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–±—Ä–∞—É–∑–µ—Ä / Email / Telegram)
4. –¢–æ–≤–∞—Ä—ã —Å –≥–∞–ª–∫–æ–π "–ò—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π" –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –æ–ø—Ä–æ—Å–µ

**–ö–∞–Ω–∞–ª—ã –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
- ‚úÖ –ë—Ä–∞—É–∑–µ—Ä (Notification API) ‚Äî MUST
- üü° Email (SMTP) ‚Äî SHOULD
- üü° Telegram ‚Äî SHOULD

---

## 4. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ò–ò-–°–ï–†–í–ò–°–ê (Python)

**LLM:** GPT-4o-mini (OpenAI)
**–§—Ä–µ–π–º–≤–æ—Ä–∫:** Python + FastAPI
**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:** openai, pydantic, python-dotenv, fastapi, uvicorn

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
backend-ai/
‚îú‚îÄ‚îÄ main.py                  # FastAPI app + –≤—Å–µ 4 endpoint'–∞
‚îú‚îÄ‚îÄ prompts.py              # –í—Å–µ –ø—Ä–æ–º—Ç—ã –¥–ª—è LLM
‚îú‚îÄ‚îÄ config.py               # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (API key, –º–æ–¥–µ–ª—å)
‚îî‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

**–ü–æ—á–µ–º—É GPT-4o-mini:**
- ‚úÖ –î–µ—à–µ–≤–æ: ~$0.15 –∑–∞ 1M –≤—Ö–æ–¥—è—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤, ~$0.6 –∑–∞ 1M –∏—Å—Ö–æ–¥—è—â–∏—Ö
- ‚úÖ –ë—ã—Å—Ç—Ä–æ: –æ—Ç–≤–µ—Ç –∑–∞ 500-1000ms
- ‚úÖ Multimodal ready (–µ—Å–ª–∏ –±—É–¥–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞—Ä—Ç–∏–Ω–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤)
- ‚úÖ JSON mode (–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞–ª–∏–¥–Ω—ã–π JSON –≤ –æ—Ç–≤–µ—Ç–µ)
- ‚úÖ –•–æ—Ä–æ—à–æ –ø–æ–Ω–∏–º–∞–µ—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–Ω–∞—è –≤ production (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- ‚ùå GPT-4: —Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ ($15 –∑–∞ 1M –≤—Ö–æ–¥—è—â–∏—Ö)
- ‚ùå Claude 3.5 Sonnet: –¥–æ—Ä–æ–∂–µ, –º–µ–¥–ª–µ–Ω–Ω–µ–µ –¥–ª—è JSON
- ‚ùå Llama 2: –Ω—É–∂–Ω–æ self-hosted, —Å–ª–æ–∂–Ω–µ–µ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å
- ‚úÖ GPT-3.5 Turbo: –¥–µ—à–µ–≤–ª–µ, –Ω–æ —Ö—É–∂–µ –∫–∞—á–µ—Å—Ç–≤–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

---

## 5. API ENDPOINTS (Backend)

### Authentication & Profile
```
POST /api/auth/login
{ "nickname": "Ivan" }
‚Üê { "user_id": 1, "profile": {...} }

GET /api/profile/:user_id
‚Üê { "income": 100000, "blacklist": [...], ... }

PUT /api/profile/:user_id
{ 
  "income": 120000, 
  "monthly_savings": 5000,
  "current_savings": 80000,
  "cooling_ranges": [...],
  "blacklist_categories": [...],
  "notification_frequency": "daily",
  "notification_channel": "browser",
  "use_savings": true
}
‚Üê { "success": true }
```

### Product Analysis (+ –ò–ò)
```
POST /api/products/check
{
  "user_id": 1,
  "product_name": "MacBook Pro",
  "price": 150000,
  "category": "–¢–µ—Ö–Ω–∏–∫–∞"
}
‚Üê
{
  "status": "COOLING" | "BLOCKED" | "APPROVED",
  "cooling_days": 30,
  "unlock_date": "2026-01-04",
  "ai_reason": "...",
  "ai_advice": "...",
  "can_afford_now": false
}
```

### Wishlist Management
```
POST /api/wishlist/:user_id
{
  "product_name": "MacBook",
  "price": 150000,
  "category": "–¢–µ—Ö–Ω–∏–∫–∞",
  "exclude_from_notifications": false
}
‚Üê { "id": 1, "unlock_date": "2026-01-04", "status": "waiting" }

GET /api/wishlist/:user_id
‚Üê [{ "id": 1, "product": "MacBook", "status": "waiting", ... }, ...]

PATCH /api/wishlist/:user_id/:product_id
{ "status": "bought" | "cancelled" | "postponed", "exclude_from_notifications": true }
‚Üê { "success": true }

DELETE /api/wishlist/:user_id/:product_id
‚Üê { "success": true }
```

### History
```
GET /api/history/:user_id
‚Üê [{ "action": "bought", "product_name": "...", "price": 5000, "date": "2025-12-20" }, ...]

POST /api/history/:user_id
{ "action": "bought" | "cancelled", "product_name": "...", "price": 5000 }
‚Üê { "success": true }
```

### Notifications (–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–æ—Å)
```
POST /api/notifications/survey
{
  "user_id": 1,
  "action": "generate"
}
‚Üê {
  "title": "–¢–≤–æ–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ–ø—Ä–æ—Å",
  "items": [...],
  "survey_id": "uuid"
}

POST /api/notifications/survey/:survey_id/answer
{
  "answers": [
    { "product_id": 1, "action": "keep" },
    { "product_id": 2, "action": "delete" }
  ]
}
‚Üê { "success": true }
```

### Swagger Documentation
```
GET /api-docs ‚Üí Swagger UI —Å –ø–æ–ª–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
GET /api-docs.json ‚Üí OpenAPI schema –≤ JSON
```

---

## 6. –ë–î SCHEMA (SQL)

```sql
-- Users (–æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å)
CREATE TABLE users (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nickname VARCHAR(50) UNIQUE NOT NULL,
  monthly_income INT NOT NULL,
  monthly_savings INT NOT NULL,
  current_savings INT NOT NULL,
  use_savings_calculation BOOLEAN DEFAULT true,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- User Settings (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ò–°)
CREATE TABLE user_settings (
  user_id INT PRIMARY KEY,
  blacklist_categories JSON,
  cooling_ranges JSON,
  notification_frequency VARCHAR(20),
  notification_channel VARCHAR(50),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- Wishlist (—Ç–æ–≤–∞—Ä—ã —Å —Ç–∞–π–º–µ—Ä–∞–º–∏)
CREATE TABLE wishlist (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  product_name VARCHAR(200) NOT NULL,
  price INT NOT NULL,
  category VARCHAR(50) NOT NULL,
  cooling_period_days INT NOT NULL,
  unlock_date DATE NOT NULL,
  status ENUM('waiting', 'ready', 'bought', 'cancelled', 'postponed') DEFAULT 'waiting',
  exclude_from_notifications BOOLEAN DEFAULT false,
  ai_recommendation TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
  INDEX (user_id, status)
);

-- History (–∏—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π)
CREATE TABLE history (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  action VARCHAR(50),
  product_name VARCHAR(200),
  price INT,
  action_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);

-- AI Prompts (–¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º—Ç–æ–≤)
CREATE TABLE ai_prompts (
  id INT PRIMARY KEY AUTO_INCREMENT,
  prompt_key VARCHAR(50) UNIQUE NOT NULL,
  prompt_text TEXT NOT NULL,
  description VARCHAR(200),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Survey Results (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ä–æ—Å–æ–≤)
CREATE TABLE survey_results (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id INT NOT NULL,
  survey_id VARCHAR(36) UNIQUE NOT NULL,
  answers JSON,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
);
```

---

## 7. LLM: GPT-4o-mini –î–ï–¢–ê–õ–¨–ù–û

### –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ GPT-4o-mini?

| –ö—Ä–∏—Ç–µ—Ä–∏–π | GPT-4o-mini | GPT-4 | Claude 3.5 | Llama 2 |
|:---|:---:|:---:|:---:|:---:|
| **–¶–µ–Ω–∞ (1M —Ç–æ–∫–µ–Ω–æ–≤)** | $0.15 –≤—Ö–æ–¥ / $0.6 –≤—ã—Ö–æ–¥ | $3 / $15 | $3 / $15 | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (self-hosted) |
| **–°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞** | ~500ms | ~1000ms | ~800ms | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ |
| **JSON mode** | ‚úÖ | ‚úÖ | ‚ùå (–Ω—É–∂–µ–Ω –ø–∞—Ä—Å–∏–Ω–≥) | ‚ö†Ô∏è |
| **–†—É—Å—Å–∫–∏–π —è–∑—ã–∫** | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | ‚úÖ –û—Ç–ª–∏—á–Ω–æ | ‚úÖ –•–æ—Ä–æ—à–æ | ‚ö†Ô∏è –°—Ä–µ–¥–Ω–µ |
| **–°–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π** | ‚úÖ 95% —Ç–æ—á–Ω–æ—Å—Ç—å | ‚úÖ 99% | ‚úÖ 95% | ‚ö†Ô∏è 70% |
| **–î–ª—è —Ö–∞–∫–∞—Ç–æ–Ω–∞** | üèÜ –ò–¥–µ–∞–ª—å–Ω–æ | ‚ùå –î–æ—Ä–æ–≥–æ | ‚ö†Ô∏è –î–æ—Ä–æ–≥–æ | ‚ö†Ô∏è –°–ª–æ–∂–Ω–æ |

**–°—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Ö–∞–∫–∞—Ç–æ–Ω (38 —á–∞—Å–æ–≤):**
- **GPT-4o-mini:** ~$5-10 (—Ç—ã—Å—è—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤)
- **GPT-4:** ~$500+ (—Å–ª–∏—à–∫–æ–º –¥–æ—Ä–æ–≥–æ)
- **Llama 2:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ, –Ω–æ –Ω—É–∂–Ω–æ self-host –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—É—Å–ª–æ–∂–Ω—è–µ—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ñ–∏—á–∏ GPT-4o-mini:

#### 1. **JSON Mode** (response_format="json_object")
```python
response = openai.ChatCompletion.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": prompt}],
    response_format={"type": "json_object"},  # üî• –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç JSON
    temperature=0.3
)
```

#### 2. **–°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º—Ç** (System Prompt –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
```python
system_prompt = """You are ZenBalance, a financial wellness assistant.
Your role is to help users make conscious spending decisions.
Always respond in Russian.
Always return valid JSON.
Be empathetic but honest."""

response = openai.ChatCompletion.create(
    model="gpt-4o-mini",
    system_prompt=system_prompt,  # üî• –ö–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
    messages=[...]
)
```

#### 3. **Temperature –Ω–∞—Å—Ç—Ä–æ–π–∫–∞**
- **–°–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π:** `temperature=0.2` (—Ç–æ—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑)
- **–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:** `temperature=0.7` (–∫—Ä–µ–∞—Ç–∏–≤–Ω–µ–µ)
- **–û–ø—Ä–æ—Å—ã:** `temperature=0.5` (–±–∞–ª–∞–Ω—Å)

#### 4. **Token Counting** (–∫–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç–æ–∏–º–æ—Å—Ç–∏)
```python
import tiktoken

enc = tiktoken.encoding_for_model("gpt-4o-mini")
tokens = len(enc.encode(prompt))
estimated_cost = (tokens / 1_000_000) * 0.15  # $0.15 –∑–∞ 1M –≤—Ö–æ–¥—è—â–∏—Ö
```

#### 5. **Caching –ø—Ä–æ–º—Ç–æ–≤** (—ç–∫–æ–Ω–æ–º–∏—è)
```python
# –°–æ—Ö—Ä–∞–Ω—è–µ–º —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø—Ä–æ–º—Ç—ã –≤ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ ai_prompts)
# –ü—Ä–∏ –≤—ã–∑–æ–≤–µ –ò–ò –Ω–µ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–æ–º—Ç, –∞ –±–µ—Ä–µ–º –∏–∑ –ë–î
# –°–æ–∫—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 30%
```

---

## 8. –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø LLM –í –ü–†–û–ï–ö–¢

### Backend ‚Üí Python AI Service

```javascript
// backend/services/aiService.js
const axios = require('axios');

const AI_SERVICE_URL = process.env.AI_SERVICE_URL || 'http://localhost:5000';

class AIService {
  async checkCategorySimilarity(userCategory, blacklist) {
    return axios.post(`${AI_SERVICE_URL}/ai/category-similarity`, {
      user_category: userCategory,
      blacklist_categories: blacklist,
    });
  }

  async getPurchaseAdvice(productData) {
    return axios.post(`${AI_SERVICE_URL}/ai/purchase-advice`, productData);
  }

  async generateSurvey(wishlistItems, nickname, monthlySavings) {
    return axios.post(`${AI_SERVICE_URL}/ai/generate-survey`, {
      wishlist_items: wishlistItems,
      nickname: nickname,
      monthly_savings: monthlySavings
    });
  }

  async getMotivation(action, product, nickname, price) {
    return axios.post(`${AI_SERVICE_URL}/ai/motivation`, {
      action, product_name: product, nickname, price
    });
  }
}

module.exports = new AIService();
```

### Python FastAPI Implementation

```python
# backend-ai/main.py
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware
import openai
import os
import json

app = FastAPI()

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

openai.api_key = os.getenv("OPENAI_API_KEY")
MODEL = "gpt-4o-mini"

# üî• SYSTEM PROMPT (–µ–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –ò–ò)
SYSTEM_PROMPT = """You are ZenBalance, a financial wellness assistant.
Your role is to help users make conscious spending decisions.
Always respond in Russian.
Always return valid JSON (no markdown).
Be empathetic but honest about financial risks.
Focus on long-term financial health."""

@app.post("/ai/category-similarity")
async def category_similarity(data: dict):
    """–°–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π"""
    user_category = data.get("user_category")
    blacklist = data.get("blacklist_categories", [])
    
    if not blacklist:
        return {"is_blocked": False, "similarity": 0, "reason": "No blacklist"}
    
    prompt = f"""Determine if '{user_category}' is related to ANY of these blacklist categories:
{json.dumps(blacklist, ensure_ascii=False)}

Return JSON:
{{
  "is_blocked": true/false,
  "similarity": 0.0-1.0,
  "related_to": "which blacklist category",
  "reason": "explanation in Russian"
}}"""

    response = openai.ChatCompletion.create(
        model=MODEL,
        system_prompt=SYSTEM_PROMPT,
        messages=[{"role": "user", "content": prompt}],
        response_format={"type": "json_object"},
        temperature=0.2
    )
    
    result = json.loads(response.choices[0].message.content)
    return result

@app.post("/ai/purchase-advice")
async def purchase_advice(data: dict):
    """–ê–Ω–∞–ª–∏–∑ —Ü–µ–ª–µ—Å–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç–∏ –ø–æ–∫—É–ø–∫–∏"""
    prompt = f"""User wants to buy: {data.get("product_name")} for ‚ÇΩ{data.get("price")}

Monthly income: ‚ÇΩ{data.get("user_income")}
Current savings: ‚ÇΩ{data.get("user_savings")}
Monthly savings: ‚ÇΩ{data.get("monthly_savings")}
Cooling period: {data.get("cooling_days")} days

Give SHORT (max 50 words) advice in Russian. Be honest about financial risks.

Return JSON:
{{
  "status": "APPROVED" | "COOLING" | "BLOCKED",
  "advice": "your advice in Russian",
  "key_message": "one-line summary",
  "confidence": 0.0-1.0
}}"""

    response = openai.ChatCompletion.create(
        model=MODEL,
        system_prompt=SYSTEM_PROMPT,
        messages=[{"role": "user", "content": prompt}],
        response_format={"type": "json_object"},
        temperature=0.5
    )
    
    result = json.loads(response.choices[0].message.content)
    return result

@app.post("/ai/generate-survey")
async def generate_survey(data: dict):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–ø—Ä–æ—Å–∞"""
    items_str = json.dumps(data.get("wishlist_items", []), ensure_ascii=False)
    
    prompt = f"""Generate an INTERACTIVE SURVEY for {data.get("nickname")} about their wishlist.

Items:
{items_str}

For EACH item, create a question: "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?"
Provide 3 options: keep, delete, postpone
Keep tone friendly and supportive.

Return JSON:
{{
  "title": "–¢–≤–æ–π –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ–ø—Ä–æ—Å üìã",
  "items": [
    {{
      "product_name": "...",
      "price": 0,
      "question": "–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?",
      "status": "waiting" | "ready",
      "days_left": 0,
      "options": [
        {{"label": "–î–∞, –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ö–æ—á—É", "action": "keep"}},
        {{"label": "–ù–µ—Ç, —É–¥–∞–ª–∏—Ç—å", "action": "delete"}},
        {{"label": "–û—Ç–ª–æ–∂–∏—Ç—å –µ—â–µ –Ω–∞ –Ω–µ–¥–µ–ª—é", "action": "postpone"}}
      ]
    }}
  ],
  "message": "–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏ —Å–≤–æ–∏ –∂–µ–ª–∞–Ω–∏—è..."
}}"""

    response = openai.ChatCompletion.create(
        model=MODEL,
        system_prompt=SYSTEM_PROMPT,
        messages=[{"role": "user", "content": prompt}],
        response_format={"type": "json_object"},
        temperature=0.5
    )
    
    result = json.loads(response.choices[0].message.content)
    return result

@app.post("/ai/motivation")
async def motivation(data: dict):
    """–ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è"""
    prompt = f"""Generate a SHORT motivational message (20-30 words) in Russian for {data.get("nickname")}.

Action: {data.get("action")}
Product: {data.get("product_name")}
Price: ‚ÇΩ{data.get("price")}

Include emojis. Be supportive.

Return JSON:
{{
  "message": "your message here"
}}"""

    response = openai.ChatCompletion.create(
        model=MODEL,
        system_prompt=SYSTEM_PROMPT,
        messages=[{"role": "user", "content": prompt}],
        response_format={"type": "json_object"},
        temperature=0.7
    )
    
    result = json.loads(response.choices[0].message.content)
    return result

@app.get("/health")
def health():
    return {"status": "ok", "service": "ZenBalance AI"}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=5000)
```

---

## 9. –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò (38 —á–∞—Å–æ–≤)

| –í—Ä–µ–º—è | –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|:---:|:---|:---:|
| **0-4—á** | Frontend: –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (2 —à–∞–≥–∞) + localStorage | üíª |
| **4-8—á** | Backend: Auth, Profile, DB schema | üíª |
| **8-12—á** | Python AI Service: FastAPI + 4 endpoint'–∞ | ü§ñ |
| **12-16—á** | Frontend: –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω + —Ä–µ–∑—É–ª—å—Ç–∞—Ç | üíª |
| **16-20—á** | Backend: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI (checkProduct logic) | üîó |
| **20-24—á** | Frontend: Wishlist (–≤–∫–ª–∞–¥–∫–∞ 1) + History (–≤–∫–ª–∞–¥–∫–∞ 2) | üíª |
| **24-28—á** | Frontend: –ü—Ä–æ—Ñ–∏–ª—å (–≤–∫–ª–∞–¥–∫–∞ 3) —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º | üíª |
| **28-32—á** | Backend: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–æ—Å + –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–±—Ä–∞—É–∑–µ—Ä) | üì¨ |
| **32-34—á** | Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è + Email –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ | üìö |
| **34-36—á** | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–∞–≥-—Ñ–∏–∫—Å—ã, –∞–¥–∞–ø—Ç–∏–≤ –º–æ–±–∏–ª—å–Ω—ã–π | üêõ |
| **36-38—á** | Demo scenario + Presentation | üé§ |

---

## 10. MUST vs SHOULD vs COULD (–§–∏–Ω–∞–ª—å–Ω—ã–π)

### MUST (–ë–µ–∑ —ç—Ç–æ–≥–æ = 0 –±–∞–ª–ª–æ–≤)
- ‚úÖ –û–Ω–±–æ—Ä–¥–∏–Ω–≥ (–ü—Ä–æ—Ñ–∏–ª—å + –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ + –î–∏–∞–ø–∞–∑–æ–Ω—ã –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è)
- ‚úÖ –í–≤–æ–¥ –∂–µ–ª–∞–µ–º–æ–π –ø–æ–∫—É–ø–∫–∏ (–ù–∞–∑–≤–∞–Ω–∏–µ, –¶–µ–Ω–∞, –ö–∞—Ç–µ–≥–æ—Ä–∏—è)
- ‚úÖ –†–∞—Å—á–µ—Ç –ø–µ—Ä–∏–æ–¥–∞ –æ—Ö–ª–∞–∂–¥–µ–Ω–∏—è (–ü–æ —Ü–µ–Ω–µ + –ø–æ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è–º + "–ø–æ–ª–æ–≤–∏–Ω–∞")
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ (–ò–ò —Å–∏–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è)
- ‚úÖ Wishlist (–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ + —Ç–∞–π–º–µ—Ä—ã)
- ‚úÖ –ò—Å—Ç–æ—Ä–∏—è (–ö—É–ø–∏–ª / –£–¥–∞–ª–∏–ª)
- ‚úÖ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (3 –≤–∫–ª–∞–¥–∫–∏)
- ‚úÖ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –æ–ø—Ä–æ—Å ("–¢—ã –≤—Å—ë –µ—â—ë —Ö–æ—á–µ—à—å —ç—Ç–æ?")
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π
- ‚úÖ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ NO-AUTH (—Ç–æ–ª—å–∫–æ –Ω–∏–∫–Ω–µ–π–º)

### SHOULD (–î–æ–±–∞–≤–ª—è–µ—Ç –æ—á–∫–∏)
- ü§ñ –ò–ò —Å–æ–≤–µ—Ç –ø–æ –ø–æ–∫—É–ø–∫–µ (LLM –∞–Ω–∞–ª–∏–∑)
- üì¨ –ë—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Notification API)
- üì¨ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (SMTP)
- üì¨ –ú–æ—Ç–∏–≤–∏—Ä—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–ò–ò)

### COULD (–ï—Å–ª–∏ –≤—Ä–µ–º—è)
- üü¢ –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–º—Ç–æ–≤
- üü¢ Telegram –Ω–æ—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üü¢ –ü–∞—Ä—Å–∏–Ω–≥ —Å—Å—ã–ª–æ–∫ –Ω–∞ —Ç–æ–≤–∞—Ä—ã
- üü¢ –ß–∞—Ç-–±–æ—Ç –¥–ª—è –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞

---

## 11. –ö–†–ê–°–ù–´–ï –§–õ–ê–ì–ò (–ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å)

üö´ **–ù–µ –¥–µ–ª–∞–π—Ç–µ:**
- ‚ùå –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (OAuth, email) ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∏–∫–Ω–µ–π–º
- ‚ùå Telegram-–±–æ—Ç –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –±–∞–Ω–∫–∞–º–∏ (—Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–æ)
- ‚ùå –ü–∞—Ä—Å–∏–Ω–≥ —Å—Å—ã–ª–æ–∫ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –Ω–µ—Ç)

‚úÖ **–î–µ–ª–∞–π—Ç–µ:**
- ‚úÖ –†–µ–∞–ª—å–Ω—ã–π REST API —Å –ø–µ—Ä–≤–æ–≥–æ –¥–Ω—è
- ‚úÖ Mock –ò–ò –æ—Ç–≤–µ—Ç—ã –µ—Å–ª–∏ –Ω–µ—Ç API –∫–ª—é—á–∞ (–ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ—Ç–æ–º)
- ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–º—Ç–∞–º–∏
- ‚úÖ –ö–æ–º–º–∏—Ç—å—Ç–µ –≤ –≥–∏—Ç –∫–∞–∂–¥—ã–π —á–∞—Å

---

## 12. –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø (.env)

```env
# Frontend
REACT_APP_API_URL=http://localhost:3001
REACT_APP_AI_URL=http://localhost:5000

# Backend
PORT=3001
DATABASE_URL=sqlite://./db.sqlite3
AI_SERVICE_URL=http://localhost:5000
NODE_ENV=development

# Python AI Service
OPENAI_API_KEY=sk-xxx...
MODEL=gpt-4o-mini
PORT=5000
```

---

**‚úÖ –ò–¢–û–ì–û: –§–∏–Ω–∞–ª—å–Ω–æ–µ –¢–ó 100% —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –¢-–ë–∞–Ω–∫–∞**

**üéØ –ò—Å–ø–æ–ª—å–∑—É–µ–º: GPT-4o-mini (OpenAI)**  
**üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: ~$5-10 –∑–∞ –≤–µ—Å—å —Ö–∞–∫–∞—Ç–æ–Ω**  
**‚ö° –°–∫–æ—Ä–æ—Å—Ç—å: 500-1000ms –Ω–∞ –∑–∞–ø—Ä–æ—Å**  
**üìä –ö–∞—á–µ—Å—Ç–≤–æ: 95%+ —Ç–æ—á–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞**

